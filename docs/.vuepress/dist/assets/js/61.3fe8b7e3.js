(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{329:function(t,a,e){"use strict";e.r(a);var s=e(13),v=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_1-概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-概述"}},[t._v("#")]),t._v(" 1 概述")]),t._v(" "),a("p",[t._v("在Kubernetes中，所有的内容都抽象为资源，用户需要通过操作资源来管理Kubernetes。")]),t._v(" "),a("blockquote",[a("p",[t._v("Kubernetes的本质上就是一个集群系统，用户可以在集群中部署各种服务，实际就是在Kubernetes集群中运行一个个容器，并将指定的程序跑在容器中。\nKubernetes的最小管理单元式pod而不是容器，所以只能将容器放在pod中，而Kubernetes一般也不会直接管理pod，而是通过"),a("code",[t._v("Pod控制器")]),t._v("来管理pod。\npod可以提供服务之后，就要考虑如何访问pod中的服务，Kubernetes提供了"),a("code",[t._v("Service")]),t._v("资源来实现这个功能。\npod中程序数据需要持久化，Kubernetes提供了各种"),a("strong",[t._v("存储")]),t._v("系统")])]),t._v(" "),a("p",[t._v("学习Kubernetes，就是学习如何对集群上的"),a("code",[t._v("Pod、Pod控制器、Service、存储")]),t._v("等各种资源进行操作。")]),t._v(" "),a("h1",{attrs:{id:"_2-资源管理方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-资源管理方式"}},[t._v("#")]),t._v(" 2 资源管理方式")]),t._v(" "),a("h2",{attrs:{id:"_2-1-概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-概述"}},[t._v("#")]),t._v(" 2.1 概述")]),t._v(" "),a("ul",[a("li",[t._v("命令式对象管理：直接使用命令操作Kubernetes资源\n"),a("code",[t._v("kubectl run nginx-pod --image=ngixn:1.17.1 --port=80")])]),t._v(" "),a("li",[t._v("命令式对象配置：通过命令配置和配置文件去操作Kubernetes资源\n"),a("code",[t._v("kubectl create/patch/delete -f nginx-pod.yaml")])]),t._v(" "),a("li",[t._v("声明式对象配置：通过apply命令和配置文件去操作Kubernetes资源\n"),a("code",[t._v("kubectl apply -f nginx-pod.yaml")])])]),t._v(" "),a("h2",{attrs:{id:"_2-2-命令式对象管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-命令式对象管理"}},[t._v("#")]),t._v(" 2.2 命令式对象管理")]),t._v(" "),a("h3",{attrs:{id:"_2-2-1-kubectl命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-kubectl命令"}},[t._v("#")]),t._v(" 2.2.1 kubectl命令")]),t._v(" "),a("p",[t._v("kubectl是Kubernetes集群的命令行工具，通过它能够对集群本身进行管理，并能够在集群上进行容器化应用的安装、部署。\nkubectl命令语法如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("kubectl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("command"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("flags"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("ul",[a("li",[a("code",[t._v("command")]),t._v("：指定要对资源的操作类型，如：create、get、delete等")]),t._v(" "),a("li",[a("code",[t._v("type")]),t._v("：指定资源类型：如：deployment、pod、service等")]),t._v(" "),a("li",[a("code",[t._v("name")]),t._v("：指定资源名称，大小写敏感")]),t._v(" "),a("li",[a("code",[t._v("flags")]),t._v("：指定额外可选参数")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("kubectl get pod "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有pod")]),t._v("\nkubectl get pod pod_name "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看某个pod")]),t._v("\nkubectl get pod pod_name "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" yaml "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看某个pod以yaml格式展示")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-2-2-资源类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-资源类型"}},[t._v("#")]),t._v(" 2.2.2 资源类型")]),t._v(" "),a("p",[t._v("Kubernetes中所有的内容都为抽象资源，可以通过"),a("code",[t._v("kubectl api-resource")]),t._v("命令查看。")]),t._v(" "),a("table",[a("tr",[a("th",[t._v("资源分类")]),t._v(" "),a("th",[t._v("资源名称")]),t._v(" "),a("th",[t._v("缩写")]),t._v(" "),a("th",[t._v("资源作用")])]),t._v(" "),a("tr",[a("td",{attrs:{rowspan:"2"}},[t._v("集群级别资源")]),t._v(" "),a("td",[t._v("nodes")]),t._v(" "),a("td",[t._v("no")]),t._v(" "),a("td",[t._v("集群组成部分")])]),t._v(" "),a("tr",[a("td",[t._v("namespace")]),t._v(" "),a("td",[t._v("ns")]),t._v(" "),a("td",[t._v("隔离Pod")])]),t._v(" "),a("tr",[a("td",[t._v("Pod资源")]),t._v(" "),a("td",[t._v("pods")]),t._v(" "),a("td",[t._v("po")]),t._v(" "),a("td",[t._v("装载容器")])]),t._v(" "),a("tr",[a("td",{attrs:{rowspan:"8"}},[t._v("Pod资源控制器")]),t._v(" "),a("td",[t._v("replicationcontrollers")]),t._v(" "),a("td",[t._v("rc")]),t._v(" "),a("td",[t._v("控制Pod资源")])]),t._v(" "),a("tr",[a("td",[t._v("replicasets")]),t._v(" "),a("td",[t._v("rs")]),t._v(" "),a("td",[t._v("控制Pod资源")])]),t._v(" "),a("tr",[a("td",[t._v("deployments")]),t._v(" "),a("td",[t._v("deploy")]),t._v(" "),a("td",[t._v("控制Pod资源")])]),t._v(" "),a("tr",[a("td",[t._v("daemonsets")]),t._v(" "),a("td",[t._v("ds")]),t._v(" "),a("td",[t._v("控制Pod资源")])]),t._v(" "),a("tr",[a("td",[t._v("dobs")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("控制Pod资源")])]),t._v(" "),a("tr",[a("td",[t._v("cronjobs")]),t._v(" "),a("td",[t._v("cj")]),t._v(" "),a("td",[t._v("控制Pod资源")])]),t._v(" "),a("tr",[a("td",[t._v("horizontalpodautoscalers")]),t._v(" "),a("td",[t._v("hpa")]),t._v(" "),a("td",[t._v("控制Pod资源")])]),t._v(" "),a("tr",[a("td",[t._v("statefulsets")]),t._v(" "),a("td",[t._v("sts")]),t._v(" "),a("td",[t._v("控制Pod资源")])]),t._v(" "),a("tr",[a("td",{attrs:{rowspan:"2"}},[t._v("服务发现资源")]),t._v(" "),a("td",[t._v("services")]),t._v(" "),a("td",[t._v("svc")]),t._v(" "),a("td",[t._v("统一 Pod 对外接口")])]),t._v(" "),a("tr",[a("td",[t._v("ingress")]),t._v(" "),a("td",[t._v("ing")]),t._v(" "),a("td",[t._v("统一 Pod 对外接口")])]),t._v(" "),a("tr",[a("td",{attrs:{rowspan:"3"}},[t._v("存储资源")]),t._v(" "),a("td",[t._v("volumeattachments")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("存储")])]),t._v(" "),a("tr",[a("td",[t._v("persistentvolumes")]),t._v(" "),a("td",[t._v("pv")]),t._v(" "),a("td",[t._v("存储")])]),t._v(" "),a("tr",[a("td",[t._v("persistentvolumeclaims")]),t._v(" "),a("td",[t._v("pvc")]),t._v(" "),a("td",[t._v("存储")])]),t._v(" "),a("tr",[a("td",{attrs:{rowspan:"2"}},[t._v("配置资源")]),t._v(" "),a("td",[t._v("configmaps")]),t._v(" "),a("td",[t._v("cm")]),t._v(" "),a("td",[t._v("配置")])]),t._v(" "),a("tr",[a("td",[t._v("secrets")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v("配置")])])]),t._v(" "),a("h3",{attrs:{id:"_2-2-3-操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-操作"}},[t._v("#")]),t._v(" 2.2.3 操作")]),t._v(" "),a("p",[t._v("Kubernetes允许对资源进行多种操作，可以通过"),a("code",[t._v("--help")]),t._v("查看详细的操作命令，例如：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("kubectl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--help")]),t._v("\nkubectl get "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--help")]),t._v("\n")])])]),a("p",[t._v("常用操作命令：")]),t._v(" "),a("table",[a("tr",[a("th",[t._v("命令分类")]),t._v(" "),a("th",[t._v("命令")]),t._v(" "),a("th",[t._v("含义")]),t._v(" "),a("th",[t._v("命令作用")])]),t._v(" "),a("tr",[a("td",{attrs:{rowspan:"6"}},[t._v("基本命令")]),t._v(" "),a("td",[t._v("create")]),t._v(" "),a("td",[t._v("创建")]),t._v(" "),a("td",[t._v("创建一个资源")])]),t._v(" "),a("tr",[a("td",[t._v("edit")]),t._v(" "),a("td",[t._v("编辑")]),t._v(" "),a("td",[t._v("编辑一个资源")])]),t._v(" "),a("tr",[a("td",[t._v("get")]),t._v(" "),a("td",[t._v("获取")]),t._v(" "),a("td",[t._v("获取一个资源")])]),t._v(" "),a("tr",[a("td",[t._v("patch")]),t._v(" "),a("td",[t._v("更新")]),t._v(" "),a("td",[t._v("更新一个资源")])]),t._v(" "),a("tr",[a("td",[t._v("delete")]),t._v(" "),a("td",[t._v("删除")]),t._v(" "),a("td",[t._v("删除一个资源")])]),t._v(" "),a("tr",[a("td",[t._v("explain")]),t._v(" "),a("td",[t._v("解释")]),t._v(" "),a("td",[t._v("解释一个资源")])]),t._v(" "),a("tr",[a("td",{attrs:{rowspan:"10"}},[t._v("运行和调试")]),t._v(" "),a("td",[t._v("run")]),t._v(" "),a("td",[t._v("运行")]),t._v(" "),a("td",[t._v("在集群中运行一个指定镜像")])]),t._v(" "),a("tr",[a("td",[t._v("expose")]),t._v(" "),a("td",[t._v("暴露")]),t._v(" "),a("td",[t._v("暴露资源为Service")])]),t._v(" "),a("tr",[a("td",[t._v("describe")]),t._v(" "),a("td",[t._v("描述")]),t._v(" "),a("td",[t._v("显示资源内部信息")])]),t._v(" "),a("tr",[a("td",[t._v("logs")]),t._v(" "),a("td",[t._v("日志")]),t._v(" "),a("td",[t._v("输出容器在Pod中的日志")])]),t._v(" "),a("tr",[a("td",[t._v("attach")]),t._v(" "),a("td",[t._v("缠绕")]),t._v(" "),a("td",[t._v("进入运行中的容器")])]),t._v(" "),a("tr",[a("td",[t._v("exec")]),t._v(" "),a("td",[t._v("执行")]),t._v(" "),a("td",[t._v("执行容器中的一个命令")])]),t._v(" "),a("tr",[a("td",[t._v("cp")]),t._v(" "),a("td",[t._v("复制")]),t._v(" "),a("td",[t._v("在Pod内外复制文件")])]),t._v(" "),a("tr",[a("td",[t._v("rollout")]),t._v(" "),a("td",[t._v("首次展示")]),t._v(" "),a("td",[t._v("管理资源的发布")])]),t._v(" "),a("tr",[a("td",[t._v("scale")]),t._v(" "),a("td",[t._v("规模")]),t._v(" "),a("td",[t._v("扩（缩）容Pod数量")])]),t._v(" "),a("tr",[a("td",[t._v("autoscale")]),t._v(" "),a("td",[t._v("自动调整")]),t._v(" "),a("td",[t._v("自动调整Pod的数量")])]),t._v(" "),a("tr",[a("td",{attrs:{rowspan:"2"}},[t._v("高级命令")]),t._v(" "),a("td",[t._v("apply")]),t._v(" "),a("td",[t._v("应用")]),t._v(" "),a("td",[t._v("通过文件对资源进行配置")])]),t._v(" "),a("tr",[a("td",[t._v("label")]),t._v(" "),a("td",[t._v("标签")]),t._v(" "),a("td",[t._v("更新资源上的标签")])]),t._v(" "),a("tr",[a("td",{attrs:{rowspan:"2"}},[t._v("其他命令")]),t._v(" "),a("td",[t._v("cluster-info")]),t._v(" "),a("td",[t._v("集群信息")]),t._v(" "),a("td",[t._v("显示集群信息")])]),t._v(" "),a("tr",[a("td",[t._v("version")]),t._v(" "),a("td",[t._v("版本")]),t._v(" "),a("td",[t._v("显示当前Client和server版本")])])]),t._v(" "),a("h3",{attrs:{id:"_2-2-4-示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-4-示例"}},[t._v("#")]),t._v(" 2.2.4 示例")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建一个namespace")]),t._v("\nkubectl create namespace dev\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取namespace")]),t._v("\nkubectl get ns\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在此namespace下创建并运行一个nginx的pod")]),t._v("\nkubectl run pod "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--image")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nginx "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-n")]),t._v(" dev\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看新创建的pod")]),t._v("\nkubectl get pod "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-n")]),t._v(" dev\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除指定pod")]),t._v("\nkubectl delete pod pod-2935js34r234-iji32\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除指定namespace")]),t._v("\nkubectl delete ns dev\n")])])]),a("h2",{attrs:{id:"_2-3-命令式对象配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-命令式对象配置"}},[t._v("#")]),t._v(" 2.3 命令式对象配置")]),t._v(" "),a("p",[t._v("命令式对象配置就是使用命令配合配置文件一起来操作Kubernetes资源。命令式对象配置的方式操作资源，可以简单的认为：命令+yaml配置文件。")]),t._v(" "),a("ol",[a("li",[t._v("创建一个ngixnpod.yaml文件：")])]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Namespace\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" dev\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Pod\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginxpod\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" dev\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("containers\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("1.17.1\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("执行create命令，创建资源：")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("kubectl create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" nginxpod.yaml\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("执行get命令，查看创建的资源：")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("kubectl get "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" nginxpod.yaml\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[t._v("执行delete命令，删除资源")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("kubectl delete "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" nginxpod.yaml\n")])])]),a("h2",{attrs:{id:"_2-4-声明式对象配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-声明式对象配置"}},[t._v("#")]),t._v(" 2.4 声明式对象配置")]),t._v(" "),a("p",[t._v("声明式对象配置通过apply命令和配置文件去操作Kubernetes的资源。它与命令式对象配置类似，不过它只有一个apply命令。")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 第一次执行kubectl apply -f yaml文件，创建资源")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kubectl apply -f nginxpod.yaml")]),t._v("\nnamespace/dev created\npod/nginxpod creted\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 再次执行一次，相当于跟新操作")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kubectl apply -f nginxpod.yaml")]),t._v("\nnamespace/dev unchanged\npod/nginxpod unchanged\n")])])]),a("p",[t._v("其实声明式对象配置就是使用apply描述一个资源最终的状态（在yaml中定义状态）")]),t._v(" "),a("ul",[a("li",[t._v("如果资源不存在，就创建，相当于"),a("code",[t._v("kubectl create")])]),t._v(" "),a("li",[t._v("如果资源已经存在，就更新，相当于"),a("code",[t._v("kubectl patch")])])])])}),[],!1,null,null,null);a.default=v.exports}}]);